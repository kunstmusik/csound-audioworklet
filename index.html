<!doctype html>
<html>
  <head>
    <title>Csound AudioWorklet Test</title>
  </head>

  <body>

  </body>

  <script src='CsoundNode.js'></script>

  <script>
    window.audioWorklet.addModule('CsoundProcessor.js').then(() => {
      console.log("Csound Processor Loaded");
      return fetch('libcsound.wasm');
    }).then(response =>
      response.arrayBuffer()
    ).then(bytes => { 
      console.log("Loaded WASM bytes."); 
      console.log("Bytes: " + bytes); 

      let context = new AudioContext();
      let csNode = new AudioWorkletNode(context, 
          "Csound",
          { wasmBytes: bytes });

      csNode.connect(context.destination);


    });


  var importObject = { imports: { print: arg => console.log(arg) } };


  </script>
</html>
